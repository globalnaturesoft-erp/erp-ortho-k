<div class="custom-show text-center">
    <h4 class="font-yellow bold uppercase mb-15">
        Báo cáo tồn kho
        <% if @period.present? %>
            <%= @period.name %>
        <% else %>
            <%= 'Từ ' + @from_date.strftime('%d/%m/%Y') if !@from_date.nil? %> <%= ' Đến ' + @to_date.strftime('%d/%m/%Y') if !@to_date.nil? %>
        <% end %>
    </h4>
</div>

<div class="text-right mb-10">
    <a target="_blank"
        href="<%= erp_ortho_k.report_sales_summary_xlsx_backend_accountings_path(params.to_unsafe_hash.merge({format: 'xlsx'})) %>"
        target="_blank"
        class="btn btn-primary"
    >Xuất excel</a>
</div>

<table class="table table-bordered order-column">
    <thead class="flip-content">
        <tr>
            <th width="20%" class="text-center bg-yellow-mint bg-font-yellow-mint text-nowrap uppercase"></th>
            <th class="text-center bg-yellow-mint bg-font-yellow-mint text-nowrap">Hàng hóa</th>
            <th width="20%" class="text-center bg-yellow-mint bg-font-yellow-mint text-nowrap">Số lượng</th>
            <th width="20%" class="text-center bg-yellow-mint bg-font-yellow-mint text-nowrap">Thành tiền</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="text-center bold uppercase" rowspan="<%= @data[:sales][:rows].count+2 %>">Xuất bán hàng</td>
        </tr>
        <% @data[:sales][:rows].each do |row| %>
            <tr>
                <td class="text-left"><%= row[:name] %></td>
                <td class="text-center font-yellow-gold"><%= format_number(row[:quantity]) %></td>
                <td class="text-right font-yellow-gold"><%= format_number(row[:amount]) %></td>
            </tr>
        <% end %>
        <tr>
            <td class="text-left bold uppercase">Tổng bán</td>
            <td class="text-center bold"><%= format_number(@data[:sales][:total][:quantity]) %></td>
            <td class="text-right bold"><%= format_number(@data[:sales][:total][:amount]) %></td>
        </tr>
        
        <tr>
            <td class="text-center bold uppercase" rowspan="<%= @data[:returns][:rows].count+2 %>">Hàng bị trả lại</td>
        </tr>
        <% @data[:returns][:rows].each do |row| %>
            <tr>
                <td class="text-left"><%= row[:name] %></td>
                <td class="text-center font-yellow-gold"><%= format_number(row[:quantity]) %></td>
                <td class="text-right font-yellow-gold"><%= format_number(row[:amount]) %></td>
            </tr>
        <% end %>
        <tr>
            <td class="text-left bold uppercase">Tổng trả</td>
            <td class="text-center bold"><%= format_number(@data[:returns][:total][:quantity]) %></td>
            <td class="text-right bold"><%= format_number(@data[:returns][:total][:amount]) %></td>
        </tr>
        
        <tr>
            <td class="bg-green-jungle bg-font-green-jungle text-center" colspan="2">
                <h4 class="bold uppercase" title="Tổng tiền doanh số bán hàng sau khi đã trừ cho chi phí hàng bị trả lại">Tổng cộng</h4>
            </td>
            <td class="bg-green-jungle bg-font-green-jungle text-center"><h4 class="bold">
                <%= format_number(@data[:sales][:total][:quantity] - @data[:returns][:total][:quantity]) %>
            </h4></td>
            <td class="bg-green-jungle bg-font-green-jungle text-right"><h4 class="bold">
                <%= format_number(@data[:sales][:total][:amount] - @data[:returns][:total][:amount]) %>
            </h4></td>
        </tr>
    </tbody>
</table>