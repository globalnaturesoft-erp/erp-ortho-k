<% if (params.to_unsafe_hash[:global_filter][:from_date].present? && params.to_unsafe_hash[:global_filter][:to_date].present?) ||
      params.to_unsafe_hash[:global_filter][:period].present? %>
    
    <div class="custom-show text-center">
        <h4 class="font-blue-madison bold uppercase mb-15">
            Báo cáo công nợ khách hàng còn lại theo tháng <br>
            <span class="font-sm">
                <% if @period_name.nil? %>
                    (<%= 'Từ tháng ' + @from_date.strftime('%m/%Y') if !@from_date.nil? %> <%= ' Đến tháng ' + @to_date.strftime('%m/%Y') if !@to_date.nil? %>)
                <% else %>
                    (<%= @period_name %>)
                <% end %>
            </span>
        </h4>
    </div>
    
    <div class="text-right mb-10">
        <a target="_blank"
            href="<%= erp_ortho_k.report_customer_remaining_liabilities_by_monthly_xlsx_backend_accountings_path(params.to_unsafe_hash.merge({format: 'xlsx'})) %>"
            target="_blank"
            class="btn btn-primary"
        >Xuất excel</a>
    </div>
    
    <table class="table table-bordered order-column">
        <thead class="flip-content">
            <tr>
                <% @report[:header].each do |title| %>
                    <th class="text-center bg-green-jungle bg-font-green-jungle text-nowrap"><%= title %></th>
                <% end %>
            </tr>
        </thead>
        <tbody>
            <% @report[:rows].each do |row| %>
                <tr>
                    <% row.each_with_index do |data,index| %>
                        <%
                            text_align = ''
                            if index == 0 # CỘT SỐ THỨ TỰ #0
                                text_align = 'text-center'
                            elsif index == 1 # CỘT TÊN KHÁCH HÀNG #1
                                text_align = 'text-left'
                            elsif index == (row.count - 1) # CỘT NV PHỤ TRÁCH #last
                                text_align = 'text-left'
                            else
                                text_align = 'text-right' # CÁC CỘT THÁNG
                            end
                        %>
                        <td class="<%= text_align %>">
                            <%=
                                if is_number?(data)
                                    format_number(data)
                                else
                                    data
                                end
                            %>
                        </td>
                    <% end %>
                </tr>
            <% end %>
            <tr>
                <% @report[:footer].each_with_index do |total,index| %>
                    <%
                        colspan = nil
                        text_align = nil
                        if index == 0
                            colspan = 2
                            text_align = 'text-center'
                        else
                            text_align = 'text-right'
                        end
                    %>
                    <td class="bg-green-jungle bg-font-green-jungle border-green-jungle <%= text_align %> bold"
                    colspan="<%= colspan %>">
                        <%=
                            if is_number?(total)
                                format_number(total)
                            else
                                total
                            end
                        %>
                    </td>
                <% end %>
            </tr>
        </tbody>
    </table>
<% else %>
    <div class="alert alert-warning"><%= t('.please_select_filter') %></div>
<% end %>