<% if !@period.present? and !@from_date.present? and !@to_date.present? %>
    <div class="alert alert-warning">
        <p>Chọn thời gian thống kê.</p>
    </div>
<% else %>
  <div class="custom-show text-center">
      <h4 class="font-yellow bold uppercase mb-15">
          Báo cáo tồn kho
          <% if @period.present? %>
              <%= @period.name %>
          <% else %>
              <%= 'Từ ' + @from_date.strftime('%d/%m/%Y') if !@from_date.nil? %> <%= ' Đến ' + @to_date.strftime('%d/%m/%Y') if !@to_date.nil? %>
          <% end %>
      </h4>
  </div>

  <div class="text-right mb-10">
      <a target="_blank"
          href="<%= erp_ortho_k.report_outside_product_xlsx_backend_inventory_index_path({format: 'xlsx'}) %>"
          target="_blank"
          class="btn btn-primary"
      >Xuất excel</a>
  </div>

  <table class="table table-bordered table-advance order-column">
    <thead>
        <tr>
          <th colspan="2" class="text-right bg-grey">Tổng cộng</th>

          <td class="text-center bg-info text-bold">
            <%= @total[:begin] %>
          </td>

          <td class="text-center bg-grey text-bold">
            <%= @total[:col1] %>
          </td>
          <td class="text-center bg-grey text-bold">
            <%= @total[:col2] %>
          </td>
          <td class="text-center bg-grey text-bold">
            <%= @total[:col3] %>
          </td>
          <td class="text-center bg-grey text-bold">
            <%= @total[:col5] %>
          </td>
          <td class="text-center bg-grey text-bold">
            <%= @total[:col4] %>
          </td>
          <td class="text-center bg-info text-bold">
            <%= @total[:end] %>
          </td>
          <td class="text-center bg-grey text-bold"></td>
        </tr>

        <tr>
          <th class="text-center bg-primary">Sản phẩm</th>
          <th class="text-center bg-primary">Đơn vị</th>
          <th class="text-center bg-primary">Dư đầu</th>
          <th class="text-center bg-primary" title="Nhập NCC">Nhập NCC</th>
          <th class="text-center bg-primary" title="Khách trả; Ký gửi trả">Hoàn kho</th>
          <th class="text-center bg-primary" title="Xuất bán; Cho mượn/Ký gửi; Tặng quà">Xuất</th>
          <th class="text-center bg-primary" title="Trả NCC">Trả NCC</th>
          <th class="text-center bg-primary" title="Hủy kho; Kiểm kho">Hư/Mất</th>
          <th class="text-center bg-primary">Dư cuối</th>
          <th class="text-left bg-primary">Ngày nhập</th>
        </tr>
    </thead>

    <% @rows.each do |row| %>
      <tr>
        <td class="text-semibold"><%= row[:product].name %></td>
        <td class="text-center"><%= row[:product].unit_name %></td>

        <td class="text-center text-bold">
          <%= row[:begin] %>
        </td>
        <td class="text-center">
          <%= row[:col1] %>
        </td>
        <td class="text-center">
          <%= row[:col2] %>
        </td>
        <td class="text-center">
          <%= row[:col3] %>
        </td>
        <td class="text-center">
          <%= row[:col5] %>
        </td>
        <td class="text-center">
          <%= row[:col4] %>
        </td>
        <td class="text-center text-bold">
          <%= row[:end] %>
        </td>
        <td class="text-left text-bold">
            <%= row[:product].delivered_delivery_details.empty? ? '' : format_date(row[:product].delivered_delivery_details.last.delivery.date) %>
        </td>
      </tr>
    <% end %>
  </table>
<% end %>
